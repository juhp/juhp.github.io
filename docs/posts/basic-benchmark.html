<!DOCTYPE html>
<html lang="en">
<head profile="http://www.w3.org/2005/10/profile">
    <meta charset="UTF-8">
    <meta name="description" content="A weblog by Jens Petersen">
    <meta name="author" content="Jens Petersen">
    <meta name=viewport content="width=device-width, initial-scale=1">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@juhp">
<meta name="twitter:creator" content="@juhp">
<meta name="twitter:title" content="Basic benchmarking">
    <meta name="twitter:description" content="Using criterion for simple Haskell benchmarking">
        <title>Basic benchmarking</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/syntax.css">
</head>
<body>
    <header>
        <nav>
          <a id="beacon" href="/">
            <div id="home-text"> juhp </div>
          </a>
        </nav>
    
        <div class="right-sidebar">
          <a class="ext-link" href="https://github.com/juhp">
        <img src="/images/github-logo.png" alt="Github Profile"/>
      </a>

          <a class="ext-link" href="https://twitter.com/juhp">
        <img src="/images/twitter-logo.png" alt="Twitter Profile"/>
      </a>
    </div>
    </header>

<div id="page">
    <div class="wrapper">
        <div class="masthead">
            <span class="title">
                Basic benchmarking
            </span>
            <br>

            <br>
            <span class="byline">by Jens Petersen</span>
            <br>
            <span class="date">Aug 29, 2020</span>
            <br>
            <div class="metadata">
            </div>
            <div class="tags">
              <span class="tag haskell">haskell</span>
            </div>
        </div>
    </div>
    <article class="post">
        <p>My first blog post using slick and in a long while...</p>
<p><a href="https://hackage.haskell.org/package/bench">Bench</a> is a cool tool written in Haskell using the <a href="https://hackage.haskell.org/package/criterion">criterion</a> for benchmarking commands in the shell. (<em>edit:</em> In 2022 you might also consider to use the simpler Haskell <a href="https://hackage.haskell.org/package/tasty-bench">tasty-bench</a> library instead.)</p>
<p>A while back hlint got me <a href="https://github.com/juhp/hs-reverse-sort">interested</a> in different ways to do reverse (descending) sort in Haskell, from a <a href="https://ro-che.info/articles/2016-04-02-descending-sort-haskell">2016 article</a> by Roman Cheplyaka.</p>
<p>As I am starting to work on adding <a href="https://hackage.haskell.org/package/typed-process">typed-process</a> to the next major version of <a href="https://hackage.haskell.org/package/simple-cmd">simple-cmd</a> and I had noticed a slowdown while experimenting with <code>typed-process</code> in <a href="https://hackage.haskell.org/package/rpmbuild-order">rpmbuild-order</a>, I thought I would try to <a href="https://github.com/juhp/hs-processes-bench">measure</a> the overhead of using <code>typed-process</code> compared to just <code>process</code> for simple command output.</p>
<p>So this is not really a very fair comparison since <code>typed-process</code> uses heavier machinery like <code>stm</code> and <code>async</code> to correctly buffer and pipe input and output, but for short lived commands there is measureable overhead. I need to experiment more (maybe I should try ghc profiling too) but I may end up using a hybrid approach of <code>process</code> for simple commands and <code>typed-process</code> for more sophisticated I/O stream handling: for example to fix bugs in the current piping commands in simple-cmd and also add a <code>tee</code> function, etc. I wonder if there could be any lower hanging fruit that could improve the performance of <code>typed-process</code>? but so far that looks hard to see.</p>
<p>ps (2022): For an example of using tasty-bench, see my tiny <a href="https://github.com/juhp/hs-string-bench">hs-string-bench</a> project.</p>

        <br>
        <br>

        <!--Share buttons-->
        <div class="social-buttons">
            <a href="https://twitter.com/share" class="twitter-share-button"
                                                data-url="https://juhp.github.io" data-text="Check out: Basic benchmarking - " data-via="juhp">Tweet</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
            <a href="https://twitter.com/juhp" class="twitter-follow-button" data-show-count="false" data-dnt="true">Follow @juhp</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
            <div class="fb-like" data-href="" data-layout="button" data-action="like" data-show-faces="true" data-share="true"></div>
        </div>
</article>

</div>

<footer>
    <a href="https://github.com/juhp/juhp.github.io">Built</a> with Haskell using <a href="https://github.com/ChrisPenner/slick">slick</a> ❤️
</footer>

<link href='https://fonts.googleapis.com/css?family=Quicksand:300,400' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
</body>
</html>
